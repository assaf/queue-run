"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("tiny-invariant"));class s{constructor(t,e){var s,r;this.body=void 0,this.headers=void 0,this.method=void 0,this.url=void 0,this.url=t,this.body=null!=(s=null==e?void 0:e.body)?s:null,this.headers=new n(null==e?void 0:e.headers),this.method=null!=(r=null==e?void 0:e.method)?r:"GET"}text(){return this.body||e.default(!1),this.body.toString("utf8")}json(){return JSON.parse(this.text())}}class r{constructor(t,e){var s,r,o;this.body=void 0,this.headers=void 0,this.status=void 0,this.statusText=void 0,this.redirected=void 0,this.ok=void 0;const i=parseInt(null!=(s=null==e||null==(r=e.status)?void 0:r.toString())?s:"200",10);if(i<200||i>599)throw new TypeError("The status provided (0) is outside the range [200, 599].");if(204===i&&(null!==t||void 0!==t))throw new TypeError("The 204 status code does not allow a body.");this.body=null!=t?t:null,this.status=i,this.statusText=null!=(o=null==e?void 0:e.statusText)?o:"",this.redirected=301===i||302===i||303===i||307===i||308===i,this.ok=i>=200&&i<300,this.headers=new n(null==e?void 0:e.headers)}}class n{constructor(t){this.headers=new Map,t instanceof n?t.forEach((([t,e])=>{this.set(t,e)})):t&&Object.entries(t).forEach((([t,e])=>{this.set(t,e)}))}append(t,e){var s;const r=null!=(s=this.headers.get(t))?s:[];r.push(String(e)),this.headers.set(t,r)}delete(t){this.headers.delete(t)}entries(){return this.headers.entries()}forEach(t){this.headers.forEach(((e,s)=>t(String(e),s)))}get(t){const e=this.headers.get(t);return e?e.join(", "):void 0}has(t){return this.headers.has(t)}keys(){return this.headers.keys()}set(t,e){this.headers.set(t,[String(e)])}values(){return new Set(Array.from(this.headers.values()).map((t=>t.join(", ")))).entries()}}function o(t){var e,s;const r={};return t.headers.forEach((([t,e])=>{r[t.toLocaleLowerCase()]=[{key:t,value:e}]})),{status:String(t.status),statusDescription:null!=(e=t.statusText)?e:"",headers:r,body:null!=(s=t.body)?s:""}}exports.handler=t=>async function(t,e){console.log({event:t});try{var i,a,u;const e=null==(i=t.Records)||null==(a=i[0].cf)?void 0:a.request;if(console.log({request:e}),!e)throw new r("",{status:422});const d=null!=(u=await(t=>new r(JSON.stringify(t),{status:200,statusText:"OK",headers:{"Content-Type":"application/json"}}))(function(t){var e;if(null!=(e=t.body)&&e.inputTruncated)throw new r("Request body too large, limit 40KB",{status:413});const o=t.body?Buffer.from(t.body.data,t.body.encoding):null,i=new n;return Object.entries(t.headers).forEach((([,t])=>{t.forEach((({key:t,value:e})=>i.append(t,e)))})),new s(t.uri,{headers:i,body:o,method:t.method})}(e)))?u:new r(null,{status:204});if(d instanceof r)return o(d);throw new TypeError("The callback must return a Response.")}catch(t){if(t instanceof r)return o(t);{const e=t instanceof Error?t.message:String(t);return o(new r(e,{status:500}))}}}(t);
//# sourceMappingURL=client-api.cjs.production.min.js.map
