{"version":3,"sources":["src/fullBuild.ts"],"sourcesContent":["import { existsSync } from \"fs\";\nimport { copyFile } from \"fs/promises\";\nimport ms from \"ms\";\nimport path from \"path\";\nimport compileSourceFiles from \"./compileSourceFiles\";\nimport createBuildDirectory from \"./createBuildDirectory\";\nimport installDependencies from \"./installDependencies\";\n\nexport default async function fullBuild({\n  buildDir,\n  envVars,\n  install,\n  sourceDir,\n}: {\n  buildDir: string;\n  envVars: Record<string, string>;\n  install: boolean;\n  sourceDir: string;\n}) {\n  await createBuildDirectory(buildDir);\n  if (install) {\n    await copyPackageJSON(sourceDir, buildDir);\n    await installDependencies(buildDir);\n    console.info();\n  }\n\n  const start = Date.now();\n  await compileSourceFiles({ sourceDir, targetDir: buildDir, envVars });\n  console.info(\"âœ¨  Done in %s.\", ms(Date.now() - start));\n}\n\nasync function copyPackageJSON(sourceDir: string, targetDir: string) {\n  const source = path.resolve(sourceDir, \"package.json\");\n  const dest = path.resolve(targetDir, \"package.json\");\n  if (!existsSync(source)) throw new Error(\"Missing package.json\");\n  await copyFile(source, dest);\n}\n"],"names":["fullBuild","buildDir","envVars","install","sourceDir","copyPackageJSON","console","info","start","Date","now","targetDir","source","resolve","dest","Error"],"mappings":";;;;kBAQ8BA,SAAS;AARZ,GAAI,CAAJ,GAAI;AACN,GAAa,CAAb,SAAa;AACvB,GAAI,CAAJ,GAAI;AACF,GAAM,CAAN,KAAM;AACQ,GAAsB,CAAtB,mBAAsB;AACpB,GAAwB,CAAxB,qBAAwB;AACzB,GAAuB,CAAvB,oBAAuB;eAEzBA,SAAS,CAAC,CAAC,CACvCC,QAAQ,GACRC,OAAO,GACPC,OAAO,GACPC,SAAS,EAMX,CAAC,EAAE,CAAC;IACF,KAAK,KAd0B,qBAAwB,UAc5BH,QAAQ;IACnC,EAAE,EAAEE,OAAO,EAAE,CAAC;QACZ,KAAK,CAACE,eAAe,CAACD,SAAS,EAAEH,QAAQ;QACzC,KAAK,KAhBuB,oBAAuB,UAgBzBA,QAAQ;QAClCK,OAAO,CAACC,IAAI;IACd,CAAC;IAED,KAAK,CAACC,KAAK,GAAGC,IAAI,CAACC,GAAG;IACtB,KAAK,KAvBwB,mBAAsB,UAuB1B,CAAC;QAACN,SAAS;QAAEO,SAAS,EAAEV,QAAQ;QAAEC,OAAO;IAAC,CAAC;IACpEI,OAAO,CAACC,IAAI,CAAC,CAAgB,uBA1BhB,GAAI,UA0BiBE,IAAI,CAACC,GAAG,KAAKF,KAAK;AACtD,CAAC;eAEcH,eAAe,CAACD,SAAiB,EAAEO,SAAiB,EAAE,CAAC;IACpE,KAAK,CAACC,MAAM,GA7BG,KAAM,SA6BDC,OAAO,CADET,SAAiB,EACP,CAAc;IACrD,KAAK,CAACU,IAAI,GA9BK,KAAM,SA8BHD,OAAO,CAFuBF,SAAiB,EAE5B,CAAc;IACnD,EAAE,OAlCuB,GAAI,aAkCbC,MAAM,GAAG,KAAK,CAAC,GAAG,CAACG,KAAK,CAAC,CAAsB;IAC/D,KAAK,KAlCkB,SAAa,WAkCrBH,MAAM,EAAEE,IAAI;AAC7B,CAAC"}