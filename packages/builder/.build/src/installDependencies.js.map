{"version":3,"sources":["src/installDependencies.ts"],"sourcesContent":["import { spawn } from \"child_process\";\nimport ms from \"ms\";\n\nexport default async function installDependencies(dirname: string) {\n  await yarn({ dirname, args: [\"install\", \"--production\"] });\n  await yarn({ dirname, args: [\"link\", \"@assaf/untitled-runtime\"] });\n}\n\nasync function yarn({ dirname, args }: { dirname: string; args: string[] }) {\n  const install = await spawn(\"yarn\", args, {\n    cwd: dirname,\n    env: {\n      PATH: process.env.PATH,\n      HOME: process.env.HOME,\n      TMPDIR: process.env.TMPDIR,\n    },\n    stdio: \"inherit\",\n    timeout: ms(\"30s\"),\n  });\n  await new Promise((resolve, reject) => {\n    install.on(\"error\", reject);\n    install.on(\"exit\", resolve);\n  });\n}\n"],"names":["installDependencies","dirname","yarn","args","install","cwd","env","PATH","process","HOME","TMPDIR","stdio","timeout","Promise","resolve","reject","on"],"mappings":";;;;kBAG8BA,mBAAmB;AAH3B,GAAe,CAAf,aAAe;AACtB,GAAI,CAAJ,GAAI;eAEWA,mBAAmB,CAACC,OAAe,EAAE,CAAC;IAClE,KAAK,CAACC,IAAI,CAAC,CAAC;QAACD,OAAO;QAAEE,IAAI,EAAE,CAAC;YAAA,CAAS;YAAE,CAAc;QAAA,CAAC;IAAC,CAAC;IACzD,KAAK,CAACD,IAAI,CAAC,CAAC;QAACD,OAAO;QAAEE,IAAI,EAAE,CAAC;YAAA,CAAM;YAAE,CAAyB;QAAA,CAAC;IAAC,CAAC;AACnE,CAAC;eAEcD,IAAI,CAAC,CAAC,CAACD,OAAO,GAAEE,IAAI,EAAsC,CAAC,EAAE,CAAC;IAC3E,KAAK,CAACC,OAAO,GAAG,KAAK,KATD,aAAe,QASP,CAAM,OAAED,IAAI,EAAE,CAAC;QACzCE,GAAG,EAAEJ,OAAO;QACZK,GAAG,EAAE,CAAC;YACJC,IAAI,EAAEC,OAAO,CAACF,GAAG,CAACC,IAAI;YACtBE,IAAI,EAAED,OAAO,CAACF,GAAG,CAACG,IAAI;YACtBC,MAAM,EAAEF,OAAO,CAACF,GAAG,CAACI,MAAM;QAC5B,CAAC;QACDC,KAAK,EAAE,CAAS;QAChBC,OAAO,MAhBI,GAAI,UAgBH,CAAK;IACnB,CAAC;IACD,KAAK,CAAC,GAAG,CAACC,OAAO,EAAEC,OAAO,EAAEC,MAAM,GAAK,CAAC;QACtCX,OAAO,CAACY,EAAE,CAAC,CAAO,QAAED,MAAM;QAC1BX,OAAO,CAACY,EAAE,CAAC,CAAM,OAAEF,OAAO;IAC5B,CAAC;AACH,CAAC"}